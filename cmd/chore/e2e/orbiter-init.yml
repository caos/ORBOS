kind: orbiter.caos.ch/Orb
version: v0
spec:
  verbose: false
clusters:
  k8s:
    kind: orbiter.caos.ch/KubernetesCluster
    version: v0
    spec:
      controlplane:
        updatesdisabled: false
        provider: providerundertest
        nodes: 1
        pool: management
        taints:
          - key: node-role.kubernetes.io/master
            effect: NoSchedule
      kubeconfig: null
      networking:
        dnsdomain: cluster.orbitertest
        network: calico
        podcidr: 100.126.4.0/22
        servicecidr: 100.127.224.0/20
      verbose: false
      versions:
        kubernetes: v1.18.8
        orbiter: ${ORBOS_E2E_TAG}
      workers:
        - updatesdisabled: false
          provider: providerundertest
          nodes: 1
          pool: application
providers:
  providerundertest:
%s
    loadbalancing:
      kind: orbiter.caos.ch/DynamicLoadBalancer
      version: v2
      spec:
        management:
          - ip: 192.168.122.2
            transport:
              - name: kubeapi
                frontendport: 6443
                backendport: 6666
                backendpools:
                  - management
                whitelist:
                  - 0.0.0.0/0
                healthchecks:
                  protocol: https
                  path: /healthz
                  code: 200
        application:
          - ip: 192.168.122.3
            transport:
              - name: httpsingress
                frontendport: 443
                backendport: 30443
                backendpools:
                  - application
                whitelist:
                  - 0.0.0.0/0
                healthchecks:
                  protocol: https
                  path: /ambassador/v0/check_ready
                  code: 200
                proxyprotocol: true
              - name: httpingress
                frontendport: 80
                backendport: 30080
                backendpools:
                  - application
                whitelist:
                  - 0.0.0.0/0
                healthchecks:
                  protocol: http
                  path: /ambassador/v0/check_ready
                  code: 200
                proxyprotocol: true

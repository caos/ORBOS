# Design

## Components

### Git Repository

In the Git Repo the `desired` and `current` state and also the `secrets` are defined as yaml files.

#### Desired state

The `desired` state is the humane defined state for the clustered system. It holds all information neccessary for `Orbiter` to create the `current` state. It is important to mention that only humanes edit this file.

#### Current state

The `current` state is the computed internal state for the cluster and is generated by `Orbiter`. It will only be edited by `Orbiter` and `Node Agent`.
Each `Node Agent` can find it's `desired` state within it. Also other components hold recieve their `desired` state with this file. For example Load Balacners. The `Node Agent` will update it's effective `current` state below it's `desired` state.

#### Secrets

### Orbiter

`Orbiter` is available as `Container Image` and `binary`, it supplies a `CLI` to run it localy. If a new cluster is setup `Orbiter` will be started local and in the first it will setup for example `kubernetes`by connecting by SSH (or Cloud Provider specifi SSH) to each node and installing the `Node Agent`. After this process it will instance `kubernetes` an when successfull deploy itself into the cluster. From that moment forward it will make sure everything stays as declared.

### Node Agent

The `Node Agent` is the component that manages packages as tools installed onto a server. It also reconciles configuration files for package managers (e.g yum, apt), loadbalancer (nginx) and so on.

It communicates with the `Orbiter` by writing to the `current.yml` which is located in the Git Repo. `Node Agent` will only update fiels in the `current` key within said yaml, because it is only for that specific key the `source of truth`.



